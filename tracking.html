<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Suivi colis | Ciza Logistics</title>

<style>
*{margin:0;padding:0;box-sizing:border-box;}
body{font-family:Arial,Helvetica,sans-serif;background:#f5f7fa;color:#111;}
.container{width:92%;max-width:1100px;margin:auto;}
html{scroll-behavior:smooth;}

/* HEADER */
.main-header{
position:fixed;width:100%;background:#000;
padding:22px 0;z-index:1000;
}
.header-container{
display:flex;justify-content:space-between;align-items:center;
}
.logo img{height:90px;}
.nav-menu{display:flex;gap:22px;align-items:center;}
.nav-menu a{
color:#fff;text-decoration:none;text-transform:uppercase;
font-size:13px;letter-spacing:1px;
}
.nav-menu a:hover{color:#D4AF37;}
.btn-outline{
border:1px solid #D4AF37;
padding:8px 14px;border-radius:14px;
color:#D4AF37;text-decoration:none;font-size:12px;
}

/* MOBILE */
.hamburger{
display:none;width:44px;height:44px;
border:1px solid rgba(255,255,255,0.2);
background:transparent;border-radius:14px;
cursor:pointer;align-items:center;justify-content:center;
}
.hamburger span,
.hamburger span:before,
.hamburger span:after{
width:20px;height:2px;background:#fff;display:block;position:relative;content:"";
}
.hamburger span:before{position:absolute;top:-6px;}
.hamburger span:after{position:absolute;top:6px;}

.mobile-overlay{
position:fixed;inset:0;background:rgba(0,0,0,0.7);
opacity:0;pointer-events:none;transition:0.3s;z-index:1999;
}
.mobile-menu{
position:fixed;top:0;right:0;height:100%;
width:280px;background:#000;
transform:translateX(100%);
transition:0.3s;padding:50px 25px;z-index:2000;
border-left:1px solid rgba(212,175,55,0.25);
}
.mobile-menu a{
display:block;color:#fff;text-decoration:none;
margin-bottom:20px;text-transform:uppercase;
padding:12px;border-radius:14px;
background:rgba(255,255,255,0.05);
}
.mobile-menu a:hover{color:#D4AF37;}
.menu-open .mobile-menu{transform:translateX(0);}
.menu-open .mobile-overlay{opacity:1;pointer-events:auto;}

/* HERO */
.hero{
padding-top:170px;padding-bottom:40px;
}
.hero-box{
background:#000;color:#fff;
border-radius:28px;padding:35px;
box-shadow:0 30px 80px rgba(0,0,0,0.2);
border:1px solid rgba(212,175,55,0.3);
}
.hero-box h1{font-size:32px;margin-bottom:10px;}
.hero-box p{color:#ccc;}

/* TRACK CARD */
.track-card{
background:#fff;border-radius:28px;
padding:30px;margin-top:25px;
box-shadow:0 30px 80px rgba(0,0,0,0.1);
border:1px solid rgba(212,175,55,0.25);
}
.track-header{
display:flex;justify-content:space-between;
align-items:center;flex-wrap:wrap;
margin-bottom:25px;
}
.track-code{
font-weight:900;font-size:18px;color:#D4AF37;
}
.status-badge{
padding:8px 16px;border-radius:999px;
background:#000;color:#fff;font-size:12px;
}

/* MAP */
.map-box{
margin-top:25px;
border-radius:20px;
overflow:hidden;
border:1px solid rgba(212,175,55,0.25);
height:300px;
}

/* OTP */
.otp-box{
margin-top:20px;
padding:15px;
border-radius:16px;
background:#000;
color:#fff;
font-weight:900;
letter-spacing:3px;
text-align:center;
display:none;
}

/* PHOTO */
.photo-box{
margin-top:20px;
display:none;
}
.photo-box img{
width:100%;
border-radius:18px;
border:1px solid rgba(212,175,55,0.4);
}

/* PDF */
.pdf-btn{
margin-top:20px;
display:none;
padding:12px 20px;
background:#D4AF37;
color:#000;
font-weight:900;
border:none;
border-radius:14px;
cursor:pointer;
}

/* TIMELINE */
.timeline{position:relative;margin-top:20px;}
.timeline:before{
content:"";position:absolute;left:12px;top:0;
width:3px;height:100%;
background:rgba(212,175,55,0.3);
}
.step{position:relative;margin-left:35px;margin-bottom:35px;}
.step:before{
content:"";position:absolute;left:-25px;top:4px;
width:18px;height:18px;border-radius:50%;
background:#fff;border:3px solid #ccc;
}
.step.active:before{
border-color:#D4AF37;background:#D4AF37;
}
.step h3{font-size:14px;margin-bottom:5px;}
.step p{font-size:13px;color:#666;}

.footer{
background:#000;color:#fff;padding:40px 0;
text-align:center;margin-top:60px;
}
.footer strong{color:#D4AF37;}

@media(max-width:900px){
.nav-menu{display:none;}
.hamburger{display:flex;}
.logo img{height:75px;}
.hero{padding-top:150px;}
}
</style>
</head>

<body>

<div class="mobile-overlay" id="mobileOverlay"></div>
<div class="mobile-menu">
<a href="index.html" onclick="closeMenu()">Accueil</a>
<a href="parcel.html" onclick="closeMenu()">Parcel</a>
<a href="tracking.html" onclick="closeMenu()">Suivi</a>
</div>

<header class="main-header">
<div class="container header-container">
<div class="logo">
<img src="https://raw.githubusercontent.com/cizaimmo/ciza-logistics/4b1ea6a2d3697e3982880984ee31dca42d8c52fc/logo.png">
</div>
<nav class="nav-menu">
<a href="index.html">Accueil</a>
<a href="parcel.html">Parcel</a>
<a href="tracking.html">Suivi</a>
</nav>
<button class="hamburger" onclick="toggleMenu()"><span></span></button>
</div>
</header>

<section class="hero">
<div class="container">
<div class="hero-box">
<h1>Suivi en temps réel</h1>
<p>Statut officiel de votre envoi Ciza Logistics.</p>
</div>
</div>
</section>

<section class="container">
<div class="track-card">

<div class="track-header">
<div class="track-code" id="trackCode">Tracking : —</div>
<div class="status-badge" id="statusBadge">Chargement...</div>
</div>

<div class="timeline">
<div class="step" id="s1"><h3>Création</h3><p>Envoi enregistré.</p></div>
<div class="step" id="s2"><h3>Paiement validé</h3><p>Transaction confirmée.</p></div>
<div class="step" id="s3"><h3>Ramassage</h3><p>Colis pris en charge.</p></div>
<div class="step" id="s4"><h3>En transit</h3><p>En route.</p></div>
<div class="step" id="s5"><h3>Livré</h3><p>Remis au destinataire.</p></div>
</div>

<div class="otp-box" id="otpBox"></div>
<div class="photo-box" id="photoBox"><img id="deliveryPhoto"></div>
<button class="pdf-btn" id="pdfBtn">Télécharger preuve</button>
<div class="map-box" id="map"></div>

</div>
</section>

<footer class="footer">
© 2026 <strong>Ciza Logistics</strong>
</footer>

<script>
function toggleMenu(){document.body.classList.toggle("menu-open");}
function closeMenu(){document.body.classList.remove("menu-open");}
document.getElementById("mobileOverlay").addEventListener("click",closeMenu);
</script>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getFirestore, collection, query, where, onSnapshot } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const firebaseConfig = {
apiKey: "AIzaSyCIUVom1diEV4ESa3QEcICOZRv0TNSydx8",
authDomain: "ciza-logistics.firebaseapp.com",
projectId: "ciza-logistics"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

const code = new URLSearchParams(window.location.search).get("code");
document.getElementById("trackCode").innerText = "Tracking : " + code;

const q = query(collection(db,"shipments"), where("trackingCode","==",code));

onSnapshot(q,(snapshot)=>{
snapshot.forEach(doc=>{
const data = doc.data();
const status = data.status || "pending";

document.getElementById("statusBadge").innerText = status.toUpperCase();
updateTimeline(status);

/* OTP */
if(data.deliveryOTP){
document.getElementById("otpBox").style.display="block";
document.getElementById("otpBox").innerText="CODE OTP : "+data.deliveryOTP;
}

/* PHOTO */
if(data.deliveryPhotoUrl){
document.getElementById("photoBox").style.display="block";
document.getElementById("deliveryPhoto").src=data.deliveryPhotoUrl;
}

/* PDF */
if(status==="delivered"){
document.getElementById("pdfBtn").style.display="inline-block";
}

/* MAP */
if(data.currentLat && data.currentLng){
document.getElementById("map").innerHTML =
`<iframe width="100%" height="100%" frameborder="0"
src="https://www.google.com/maps?q=${data.currentLat},${data.currentLng}&z=15&output=embed"></iframe>`;
}
});
});

function updateTimeline(status){
const steps=["s1","s2","s3","s4","s5"];
steps.forEach(s=>document.getElementById(s).classList.remove("active"));

if(status==="pending"){document.getElementById("s1").classList.add("active");}
if(status==="payment_validated"){["s1","s2"].forEach(id=>document.getElementById(id).classList.add("active"));}
if(status==="picked_up"){["s1","s2","s3"].forEach(id=>document.getElementById(id).classList.add("active"));}
if(status==="in_transit"){["s1","s2","s3","s4"].forEach(id=>document.getElementById(id).classList.add("active"));}
if(status==="delivered"){steps.forEach(id=>document.getElementById(id).classList.add("active"));}
}
</script>

</body>
</html>
