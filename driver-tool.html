<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ciza Logistics | Driver Portal</title>

<style>
*{margin:0;padding:0;box-sizing:border-box;}
body{font-family:Arial,Helvetica,sans-serif;background:#fff;color:#111;}
.container{width:92%;max-width:1200px;margin:auto;}
html{scroll-behavior:smooth;}

/* HEADER */
.main-header{
position:fixed;width:100%;background:rgba(0,0,0,0.98);
padding:22px 0;z-index:1000;
}
.header-container{display:flex;justify-content:space-between;align-items:center;}
.logo img{height:78px;}
.nav-menu{display:flex;gap:22px;align-items:center;}
.nav-menu a{
color:#fff;text-decoration:none;text-transform:uppercase;
font-size:13px;letter-spacing:1px;
}
.nav-menu a:hover{color:#D4AF37;}
.btn-outline{
border:1px solid #D4AF37;
padding:8px 14px;border-radius:12px;
color:#D4AF37;text-decoration:none;font-size:12px;
}

/* SECTION */
.section{padding:140px 0 60px 0;}
.section h2{font-size:28px;margin-bottom:20px;}

.form-shell{
background:#0f0f10;
border-radius:26px;
padding:26px;
box-shadow:0 30px 90px rgba(0,0,0,0.25);
border:1px solid rgba(212,175,55,0.18);
color:#fff;
}

label{
display:block;
font-size:12px;
color:#bfbfbf;
margin:12px 0 6px;
text-transform:uppercase;
}

input{
width:100%;
padding:14px;
border-radius:14px;
border:1px solid rgba(255,255,255,0.10);
background:rgba(0,0,0,0.35);
color:#fff;
}

button{
margin-top:18px;
width:100%;
padding:14px;
border-radius:16px;
border:none;
font-weight:900;
cursor:pointer;
background:#D4AF37;
color:#000;
}

.status-box{
margin-top:20px;
padding:14px;
border-radius:14px;
background:rgba(212,175,55,0.1);
border:1px solid rgba(212,175,55,0.3);
color:#f6e7b5;
}

.footer{
background:#000;color:#fff;padding:40px 0;text-align:center;margin-top:60px;
}
</style>
</head>

<body>

<header class="main-header">
<div class="container header-container">
<div class="logo">
<img src="https://raw.githubusercontent.com/cizaimmo/ciza-logistics/4b1ea6a2d3697e3982880984ee31dca42d8c52fc/logo.png">
</div>
<nav class="nav-menu">
<a href="index.html">Accueil</a>
<a href="tracking.html">Suivi colis</a>
<a href="parcel.html">Créer envoi</a>
</nav>
</div>
</header>

<section class="section">
<div class="container">

<h2>Driver Portal</h2>

<div class="form-shell">

<label>Code Tracking</label>
<input type="text" id="tracking" placeholder="CL-BI-XXXXXXXX">

<label>OTP Client</label>
<input type="text" id="otp" placeholder="Ex: 4821">

<button onclick="validateDelivery()">Valider Livraison</button>

<div class="status-box" id="result">
Statut en attente...
</div>

</div>
</div>
</section>

<footer class="footer">
© 2026 Ciza Logistics – Driver System
</footer>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getFirestore, collection, query, where, getDocs, updateDoc } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

const firebaseConfig = {
apiKey: "AIzaSyCIUVom1diEV4ESa3QEcICOZRv0TNSydx8",
authDomain: "ciza-logistics.firebaseapp.com",
projectId: "ciza-logistics",
storageBucket: "ciza-logistics.firebasestorage.app",
messagingSenderId: "751524585771",
appId: "1:751524585771:web:6720db623a0ef70f56e56e"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

window.validateDelivery = async function(){

const tracking = document.getElementById("tracking").value.trim();
const otp = document.getElementById("otp").value.trim();

if(!tracking || !otp){
document.getElementById("result").innerText="Veuillez remplir tracking et OTP.";
return;
}

const q = query(collection(db,"shipments"), where("trackingCode","==",tracking));
const snapshot = await getDocs(q);

if(snapshot.empty){
document.getElementById("result").innerText="Tracking introuvable.";
return;
}

snapshot.forEach(async(docSnap)=>{
const data = docSnap.data();

if(data.deliveryOtp !== otp){
document.getElementById("result").innerText="OTP incorrect.";
return;
}

await updateDoc(docSnap.ref,{
status:"delivered",
deliveredAt:new Date()
});

document.getElementById("result").innerText="Livraison confirmée ✔";
});
}
</script>

</body>
</html>
